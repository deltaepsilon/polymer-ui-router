<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="polymer-uirouter.html">
<link rel="import" href="uirouter-uiview.html">
<link rel="import" href="uirouter-sref.html">
<link rel="import" href="views/qux-cmp.html">
<link rel="import" href="views/foo-comp.html">
<link rel="import" href="views/bar-comp.html">
<link rel="import" href="views/baz-comp.html">
<link rel="import" href="views/footer-comp.html">
<link rel="import" href="views/header-comp.html">
<link rel="import" href="views/arguments-comp.html">
<link rel="import" href="views/resolve-comp.html">

<dom-module id="demo-app">
    <template>
        <style>
            :host {
                display: block;
            }

            .active{
                font-weight:bold;
                text-transform: uppercase;
            }

        </style>

        <polymer-uirouter
                id="ui-router" router="{{router}}"
                location-plugin="[[locationPlugin]]"
                states="[[routerStates]]" visualizer debug-tracing
                on-uirouter-success="handleSuccess">
        </polymer-uirouter>

        <p>States</p>
        <ul>
            <template is="dom-repeat" items="[[states]]">
                <li>name: [[item.name]] url: [[item.url]]</li>
            </template>
        </ul>

        <p>current state: [[currentState]]</p>
        <p>params: [[paramsJson]]</p>

        Links:
        <ul>
            <li>
                <uirouter-sref state="qux_route">Qux component</uirouter-sref>
            </li>
            <li>
                <uirouter-sref state="foo">Foo</uirouter-sref>
            </li>
            <li>
                <uirouter-sref state="resolve">Resolve</uirouter-sref>
            </li>
            <li>
                <uirouter-sref state="arg" param-argument-id="99">With arguments directly</uirouter-sref>
            </li>
            <li>
                <uirouter-sref state="arg" route-params='{"argumentId":123, "test":8}'>With arguments as single object
                </uirouter-sref>
            </li>
            <li>
                <uirouter-sref state="bar.baz">Bar.baz</uirouter-sref>
            </li>
        </ul>

        <uirouter-uiview name="header"></uirouter-uiview>
        <div style="border: 1px solid #eeeeee; padding: 10px">
            <uirouter-uiview></uirouter-uiview>
        </div>
        <uirouter-uiview name="footer"></uirouter-uiview>

        <br><br><br><br><br><br><br><br>


    </template>

    <script>
        Polymer({
            is: 'demo-app',
            properties: {

                locationPlugin: {
                    type:Object,
                    value: function(){
                        return routerCore.pushStateLocationPlugin;
                    }
                },

                routerStates: {
                    type: Object,
                    value: function () {
                        return [
                            {name: "index_route", url: "/index"},
                            {name: "qux_route", url: "/qux", component: "qux-cmp"},
                            {name: "foo", url: "/foo", component: "foo-comp"},
                            {name: "arg", url: "/arg/:argumentId", component: "arguments-comp"},
                            {
                                name: "resolve", url: "/resolve", component: "resolve-comp",
                                resolve: [{
                                    token: 'person',
                                    deps: ['$transition$'],
                                    resolveFn: function (trans) {
                                        return new Promise(function (resolve, reject) {
                                            setTimeout(resolve, 2000, 'one');
                                        });
                                    }
                                }]
                            },
                            {
                                name: "bar", url: "/bar", component: "bar-comp",
                                views: {
                                    'footer': {component: 'footer-comp'}
                                }
                            },
                            {
                                name: "bar.baz", url: "/baz", component: "baz-comp",
                                views: {
                                    '!header': {component: 'header-comp'}
                                }
                            },
                        ]
                    }
                }
            },

            handleSuccess: function (event) {
                this.currentState = event.detail.transition.to().name;
                this.paramsJson = JSON.stringify(event.detail.transition.params());
            }
        });
    </script>
</dom-module>
