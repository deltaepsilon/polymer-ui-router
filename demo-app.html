<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="bower_components/iron-location/iron-location.html">
<link rel="import" href="bower_components/paper-input/paper-input.html">
<link rel="import" href="polymer-uirouter.html">
<link rel="import" href="uirouter-state.html">
<link rel="import" href="uirouter-state-view.html">
<link rel="import" href="uirouter-uiview.html">
<link rel="import" href="uirouter-sref.html">
<link rel="import" href="views/qux-cmp.html">
<link rel="import" href="views/foo-comp.html">
<link rel="import" href="views/bar-comp.html">
<link rel="import" href="views/baz-comp.html">
<link rel="import" href="views/footer-comp.html">
<link rel="import" href="views/header-comp.html">
<link rel="import" href="views/arguments-comp.html">
<link rel="import" href="views/resolve-comp.html">

<dom-module id="demo-app">
    <template>
        <style>
            :host {
                display: block;
            }
        </style>

        <polymer-uirouter id="ui-router" router="{{router}}" states="{{states}}" visualizer debug-tracing
        on-uirouter-success="handleSuccess">
            <uirouter-state name="index_route" url="/index"></uirouter-state>
            <uirouter-state name="qux_route" url="/qux"
                                     component="qux-cmp"></uirouter-state>
            <uirouter-state name="foo" url="/foo" component="foo-comp"></uirouter-state>
            <uirouter-state name="arg" url="/arg/:argumentId" component="arguments-comp"></uirouter-state>
            <uirouter-state name="resolve" url="/resolve" resolve="[[resolveInfo]]"
                            component="resolve-comp"></uirouter-state>
            <uirouter-state name="bar" url="/bar" component="bar-comp">
                <uirouter-state-view name="footer" component="footer-comp"></uirouter-state-view>
            </uirouter-state>
            <uirouter-state name="bar.baz" url="/baz" component="baz-comp">
                <uirouter-state-view name="!header" component="header-comp"></uirouter-state-view>
            </uirouter-state>
        </polymer-uirouter>

        <p>States</p>
        <ul>
            <template is="dom-repeat" items="[[states]]">
                <li>name: [[item.name]] url: [[item.url]]</li>
            </template>
        </ul>

        <p>current state: [[currentState]]</p>
        <p>params: [[paramsJson]]</p>

        Links:
        <ul>
            <li><uirouter-sref state="qux_route">Qux component</uirouter-sref></li>
            <li><uirouter-sref state="foo">Foo</uirouter-sref></li>
            <li><uirouter-sref state="resolve">Resolve</uirouter-sref></li>
            <li><uirouter-sref state="arg" param-argument-id="99">With arguments directly</uirouter-sref></li>
            <li><uirouter-sref state="arg" route-params='{"argumentId":123, "test":8}'>With arguments as single object</uirouter-sref></li>
            <li><uirouter-sref state="bar.baz">Bar.baz</uirouter-sref></li>
        </ul>

        <uirouter-uiview name="header"></uirouter-uiview>
        <div style="border: 1px solid #eeeeee; padding: 10px">
        <uirouter-uiview></uirouter-uiview>
        </div>
        <uirouter-uiview name="footer"></uirouter-uiview>

        <br><br><br><br><br><br><br><br>


    </template>

    <script>
        Polymer({
            is: 'demo-app',
            properties: {
                dummyTemplate: {
                    type: String,
                    value: '<strong>this</strong> is a dummy template restamped by ui-view'
                },
                resolveInfo: {
                    type: Object,
                    value: function(){
                        return [{
                            token: 'person',
                            deps: ['$transition$'],
                            resolveFn: function (trans) {
                                return new Promise(function(resolve, reject) {
                                    setTimeout(resolve, 1000, 'one');
                                });
                            }
                        }]
                    }
                }
            },

            handleSuccess: function(event){
                this.currentState = event.detail.transition.to().name;
                this.paramsJson = JSON.stringify(event.detail.transition.params());
            }
        });
    </script>
</dom-module>
